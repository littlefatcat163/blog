<!DOCTYPE html><html lang="en" data-default-color-scheme="dark"><head><link rel="stylesheet" href="/blog/css/custom.css"><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/blog/img/docs.png"><link rel="icon" href="/blog/img/docs.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#000"><meta name="author" content="littlefatcat"><meta name="keywords" content=""><meta name="description" content="协同工作流，应对生产过程中各式各样的问题"><meta property="og:type" content="article"><meta property="og:title" content="GitFlow"><meta property="og:url" content="https://littlefatcat163.github.io/blog/2023/04/11/git/flow/index.html"><meta property="og:site_name" content="Blog"><meta property="og:description" content="协同工作流，应对生产过程中各式各样的问题"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://littlefatcat163.github.io/blog/img/git/git.webp"><meta property="article:published_time" content="2023-04-11T09:34:24.000Z"><meta property="article:modified_time" content="2024-03-16T03:27:44.147Z"><meta property="article:author" content="littlefatcat"><meta property="article:tag" content="git"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://littlefatcat163.github.io/blog/img/git/git.webp"><meta name="description" content="协同工作流，应对生产过程中各式各样的问题"><meta name="referrer" content="no-referrer-when-downgrade"><meta http-equiv="Cache-Control" content="no-cache,no-store,must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><title>GitFlow - Blog</title><link rel="stylesheet" href="//cdn.staticfile.net/bootstrap/5.3.2/css/bootstrap.min.css"><link rel="stylesheet" href="/blog/css/main.css"><link id="highlight-css" rel="stylesheet" href="//lib.baomitu.com/highlight.js/11.9.0/styles/qtcreator-light.min.css"><link id="highlight-css-dark" rel="stylesheet" href="//lib.baomitu.com/highlight.js/11.9.0/styles/qtcreator-dark.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><script id="lnote-configs">var LNote=window.LNote||{version:"1.2.8",root:"/blog/"}</script><script src="/blog/js/utils.js"></script><script src="/blog/js/color-schema.js"></script><meta name="generator" content="Hexo 7.1.1"></head><body><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none;overflow:hidden;width:0;height:0"><defs><symbol id="success" viewBox="0 0 16 16" fill="currentColor"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/></symbol><symbol id="info" viewBox="0 0 16 16" fill="currentColor"><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/></symbol><symbol id="warning" viewBox="0 0 16 16" fill="currentColor"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 4a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0l.35-3.507A.905.905 0 0 0 8 4zm.002 6a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></symbol><symbol id="danger" viewBox="0 0 16 16" fill="currentColor"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></symbol><symbol id="tap-link" viewBox="0 0 16 16" fill="currentColor"><path d="M11.53,7.28h2.72a1.75,1.75,0,0,0,0-3.5H8.91l-.24-1.2A1.49,1.49,0,0,0,7,1.39l-3.1.34a2.34,2.34,0,0,0-1.11.41L.67,3.57A1.5,1.5,0,0,0,0,4.82V11.2a1.48,1.48,0,0,0,.76,1.3L3.2,13.9a3.54,3.54,0,0,0,1.39.44l2.71.27a2,2,0,0,0,2.19-1.79,1.27,1.27,0,0,0,0-.2V12l.25-.19a2.36,2.36,0,0,0,.71-.88,2.63,2.63,0,0,0,.11-1.16V9.68a1.3,1.3,0,0,0,.64-.56,2.78,2.78,0,0,0,.29-.74,5.28,5.28,0,0,0,0-1.05Z" transform="translate(0 -1.38)"/></symbol><symbol id="plus-circle-fill" viewBox="0 0 16 16" fill="currentColor"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/></symbol><symbol id="dash-circle-fill" viewBox="0 0 16 16" fill="currentColor"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1h-7z"/></symbol><symbol id="x" viewBox="0 0 16 16" fill="currentColor"><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/></symbol><symbol id="check" viewBox="0 0 16 16" fill="currentColor"><path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/></symbol><symbol id="clipboard" viewBox="0 0 16 16" fill="currentColor"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></symbol><symbol id="question-circle-fill" viewBox="0 0 16 16" fill="currentColor"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.496 6.033h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286a.237.237 0 0 0 .241.247zm2.325 6.443c.61 0 1.029-.394 1.029-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94 0 .533.425.927 1.01.927z"/></symbol><symbol id="chevron-left" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/></symbol><symbol id="chevron-right" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></symbol><symbol id="chat-left-dots" viewBox="0 0 16 16" fill="currentColor"><path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M5 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/></symbol></defs></svg><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/blog/"><strong>Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent" style="flex-grow:0"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/blog/"><i class="iconfont icon-home-fill"></i> <span>Home</span></a></li><li class="nav-item"><a class="nav-link" href="/blog/archives"><i class="iconfont icon-archive-fill"></i> <span>Archives</span></a></li><li class="nav-item"><a class="nav-link" href="/blog/categories"><i class="iconfont icon-category-fill"></i> <span>Categories</span></a></li><li class="nav-item"><a class="nav-link" href="/blog/tags"><i class="iconfont icon-tags-fill"></i> <span>Tags</span></a></li><li class="nav-item"><a class="nav-link" href="/blog/about"><i class="iconfont icon-user-fill"></i> <span>About</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-bs-toggle="modal" data-bs-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/blog/img/git/git.webp) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="fs-1"><span id="subtitle" data-typed-text="GitFlow"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2023-04-11 17:34" pubdate>Tuesday, April 11, 2023 5:34 PM</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3.6k words </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 30 mins</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><p class="alert alert-info">Last updated on Saturday, March 16, 2024 11:27 AM</p><div class="markdown-body"><blockquote><p><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2015/12/git-workflow.html">https://www.ruanyifeng.com/blog/2015/12/git-workflow.html</a></p></blockquote><p>在真实的生产过程中，前面的协同工作流还是不能满足工作的要求。这主要因为我们的生产过程是比较复杂的，软件生产中会有各式各样的问题，并要面对不同的环境。我们要在不停地开发新代码的同时，维护线上的代码，于是，就有了下面这些需求。</p><ol><li><p>希望有一个分支是非常干净的，上面是可以发布的代码，上面的改动永远都是可以发布到生产环境中的。这个分支上不能有中间开发过程中不可以上生产线的代码提交。</p></li><li><p>希望当代码达到可以上线的状态时，也就是在 alpha&#x2F;beta release 时，在测试和交付的过程中，依然可以开发下一个版本的代码。</p></li><li><p>最后，对于已经发布的代码，也会有一些 Bug-fix 的改动，不会将正在开发的代码提交到生产线上去。</p></li></ol><p>所以，GitFlow由此产生，核心思想如下图所示：<br><img src="/blog/img/git/gitflow.jpg" alt="gitflow"></p><h2 id="GitFlow"><a href="#GitFlow" class="headerlink" title="GitFlow"></a>GitFlow</h2><p>整个代码库有五种branch</p><ul><li><span class="badge text-bg-info">Main</span> 用于发布环境，上面的每一次commit都是可以发布的。</li><li><span class="badge text-bg-success">Feature</span> 用于开发功能，对应开发环境。</li><li><span class="badge text-bg-primary">Develop</span> 用于集成测试环境；功能开发完成，就向 <span class="badge text-bg-primary">Develop</span> 合并，合并完成后，删除功能分支。</li><li><span class="badge text-bg-warning">Release</span> 用于预发布环境；当 <span class="badge text-bg-primary">Develop</span> 测试到达可以发布状态时，开出一个<span class="badge text-bg-warning">Release</span>分支，然后做发布前的准备工作。为什么需要<span class="badge text-bg-warning">Release</span>，因为开发可以继续向前，不会被发布限制commit。<blockquote><p>当 <span class="badge text-bg-warning">Release</span> 达到可以上线的状态，需要把 <span class="badge text-bg-warning">Release</span> 向 <span class="badge text-bg-info">Main</span> 和 <span class="badge text-bg-primary">Develop</span> 同时合并，确保代码的一致性，然后再删掉<span class="badge text-bg-warning">Release</span>。</p></blockquote></li><li><span class="badge text-bg-danger">Hotfix</span> 用于处理生产线上的 Bug-fix，每个线上 Bug-fix 都需要开一个<span class="badge text-bg-danger">Hotfix</span>，完成后，向 <span class="badge text-bg-info">Main</span> 和 <span class="badge text-bg-primary">Develop</span> 合并，然后删除 <span class="badge text-bg-danger">Hotfix</span>。</li></ul><div class="note alert alert-success"><div><p>从GitFlow流程中可以看到</p><ol><li>我们需要长期维护 <span class="badge text-bg-info">Main</span> 和 <span class="badge text-bg-primary">Develop</span> 两个分支。</li><li>这其中的方式还是有一定复杂度的，尤其是 <span class="badge text-bg-warning">Release</span> 和 <span class="badge text-bg-danger">Hotfix</span> 分支需要同时向两个分支作合并。所以，如果没有一个好的工具来支撑的话，这会因为我们可能会忘了做一些操作而导致代码不一致。</li><li>GitFlow 协同虽然工作流比较重。但是它几乎可以应对所有公司的各种开发流程，包括瀑布模型，或是快速迭代模型。</li></ol></div></div><h2 id="GitFlow-Apply"><a href="#GitFlow-Apply" class="headerlink" title="GitFlow Apply"></a>GitFlow Apply</h2><span class="badge text-bg-success">feature</span> <span class="badge text-bg-warning">release</span> <span class="badge text-bg-danger">bugfix</span><p>都属于临时需要，使用完毕后，应该即时删除</p><h3 id="a-new-feature"><a href="#a-new-feature" class="headerlink" title="a new feature"></a>a new feature</h3><ol><li><p>creating a feature branch from develop</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">git checkout develop<br>git chehckout -b feature-branch<br></code></pre></td></tr></table></figure></li><li><p>finishing the feature branch</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">git checkout develop<br>git merge --no-ff feature-branch<br>git branch -d feature-branch<br></code></pre></td></tr></table></figure></li></ol><h3 id="release-branches"><a href="#release-branches" class="headerlink" title="release branches"></a>release branches</h3><span class="badge text-bg-warning">release</span>预发布分支，在发布到正式版（合入<span class="badge text-bg-info">main</span>）之前，<span class="badge text-bg-warning">release</span> 是从<span class="badge text-bg-primary">develop</span>分出来，预发布结束后，需要合并进<span class="badge text-bg-primary">develop</span> 和 <span class="badge text-bg-info">main</span><ol><li><p>create a release branch from develop</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">git checkout develop<br>git checkout -b release-1.0.0<br></code></pre></td></tr></table></figure></li><li><p>release branch merge to main</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">git checkout main<br>git merge --no-ff release-1.0.0<br>git tag 1.0.0<br><br>git checkout develop<br>git merge --no-ff release-1.0.0<br><br>git branch -d release-1.0.0<br></code></pre></td></tr></table></figure></li></ol><h3 id="bugfix"><a href="#bugfix" class="headerlink" title="bugfix"></a>bugfix</h3><p>软件正式发布后，出现地bug，需要在从 <span class="badge text-bg-info">main</span> 拉出分支，修补结束后，合并进<span class="badge text-bg-primary">develop</span> 和 <span class="badge text-bg-info">main</span></p><ol><li><p>create a bugfix branch from main</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">git checkout main<br>git checkout -b bugfix-1.0.1<br></code></pre></td></tr></table></figure></li><li><p>bugfix branch merge to main and develop</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">git checkout main<br>git merge --no-ff bugfix-1.0.1<br>git tag 1.0.1<br><br>git checkout develop<br>git merge --no-ff bugfix-1.0.1<br><br>git branch -d bugfix-1.0.1<br></code></pre></td></tr></table></figure></li></ol><h2 id="GitHub-Flow"><a href="#GitHub-Flow" class="headerlink" title="GitHub Flow"></a>GitHub Flow</h2><p>Git Flow的简化版，专门作“持续发布”，如web的持续发布。</p><p><img src="/blog/img/git/githubflow.jpg" alt="GitHub Flow"></p><div class="note alert alert-primary"><div><p>只有 <span class="badge text-bg-info">main</span> 分支，要求保证高质量，对开发者要求很高。</p><ol><li>根据需求，从main拉出新分支，不区分功能或者补丁分支。</li><li>新分支开发完成后，或者待完善，就可以向 <span class="badge text-bg-info">main</span> 发起一个 <code>pull request</code> 。</li><li>大家一起review代码，在这个过程中，还可以不断提交。</li><li><code>pull request</code> 被接受，合并进 <span class="badge text-bg-info">main</span>，删除原来的分支，重新部署。</li></ol></div></div><p>如果发布有指定时间，那么会导致线上的版本落后于<span class="badge text-bg-info">main</span>，这个时候就需要建一个 <span class="badge text-bg-success">production</span> 来追踪线上版本。</p><h2 id="GitHub-Forking-Flow"><a href="#GitHub-Forking-Flow" class="headerlink" title="GitHub Forking Flow"></a>GitHub Forking Flow</h2><div class="note alert alert-success"><div><ol><li>每个开发人员都把“官方库”的代码 fork 到自己的代码仓库中。</li><li>然后，开发人员在自己的代码仓库中做开发，想干啥干啥。</li><li>因此，开发人员的代码库中，需要配两个远程仓库，一个是自己的库，一个是官方库（用户的库用于提交代码改动，官方库用于同步代码）。</li><li>然后在本地建“功能分支”，在这个分支上做代码开发。</li><li>这个功能分支被 push 到开发人员自己的代码仓库中。</li><li>然后，向“官方库”发起 pull request，并做 Code Review。</li><li>一旦通过，就向官方库进行合并。</li></ol></div></div><h2 id="GitLab-Flow"><a href="#GitLab-Flow" class="headerlink" title="GitLab Flow"></a>GitLab Flow</h2><p>GitLab Flow 最大的原则“上游优先” <code>upstream first</code>，只存在一个主分支 <span class="badge text-bg-primary">master</span>，它是所有分支的上游，只有上游采纳代码变化，才能应用到其他分支。</p><p><img src="/blog/img/git/gitlabflow.jpg" alt="GitLab Flow"></p><div class="note alert alert-info"><div><p>对于“持续发布”的项目，它建议在 <span class="badge text-bg-primary">master</span> 外，再建立不同的环境分支，如</p><ul><li><code>master</code> 开发</li><li><code>pre-production</code> 预发布</li><li><code>production</code> 生产<br>代码的变化，必须由“上游”向“下游”发展，如生产环境出现了bug，这时需要新建功能分支，先合到 <code>master</code> ， 确认没问题，再 <code>cherry-pick</code> 到 <code>pre-production</code>, 到这一步也没有问题，才进入 <code>prodution</code>。</li></ul></div></div><div class="note alert alert-danger"><div><p>只有紧急情况，才允许跳过上游，直接合并到下游分支。</p></div></div><p>对于版本发布，每一个稳定版本，都要从master拉出一个分支。</p><p><img src="/blog/img/git/gitlabstable.jpg" alt="GitLab Flow"></p><p>对于“版本发布”的项目，建议的做法是每一个稳定版本，都要从 <span class="badge text-bg-primary">master</span> 拉出一个分支，如 <code>2-3-stable</code> <code>2-4-stable</code> 等。</p><div class="note alert alert-danger"><div><p>以后，只有修补bug，才允许将代码合并到这些分支，并且更新小版本号。</p></div></div><div class="note alert alert-success"><div><p>实际应用：</p><ol><li>从<span class="badge text-bg-primary">master</span>拉个人分支开发，<code>feature-name</code></li><li>开发完成，在迭代结束前，合入<span class="badge text-bg-primary">master</span></li><li><span class="badge text-bg-primary">master</span> 发布到 dev 环境</li><li>测试通过后，从 <span class="badge text-bg-primary">master</span> 拉出发布分支 <span class="badge text-bg-info">release-version</span></li><li>有bug，在<span class="badge text-bg-info">release-version</span>拉出分支修复，修复完成后再合入 <span class="badge text-bg-info">release-version</span></li><li>正式发布版本，如果有bug，同5的操作</li><li>等待发布版本稳定后，再将<span class="badge text-bg-info">release-version</span> 合入 <span class="badge text-bg-primary">master</span></li></ol></div></div><h2 id="Work-Trick"><a href="#Work-Trick" class="headerlink" title="Work Trick"></a>Work Trick</h2><h3 id="Pull-Rquest"><a href="#Pull-Rquest" class="headerlink" title="Pull Rquest"></a>Pull Rquest</h3><p>功能分支合进 <span class="badge text-bg-primary">master</span>，必须通过 <code>Pull Request</code> 或 <code>Merge Request</code></p><div class="note alert alert-warning"><div><p>提pr的时候，可以在pr comment里面<code>@相关人员或团队</code>，引起他们注意。</p></div></div><h3 id="Protected-branch"><a href="#Protected-branch" class="headerlink" title="Protected branch"></a>Protected branch</h3><span class="badge text-bg-primary">master</span> 应该受保护，不是每个人都可以修改这个分支，以及拥有审批 `Pull Request` 的权限。<h3 id="Issue"><a href="#Issue" class="headerlink" title="Issue"></a>Issue</h3><p>Issue用于Bug追踪和需求管理，建议先建Issue，再建对应的功能分支，分支可以和Issue名字保持一致。</p><p>开发完成后，在提交说明里面，可以写上 <code>fix: #5</code> 或 <code>closes #10</code>，Github规定，只要 commit message里面有下面动词 + 编号，就会关闭对应的issue。</p><div class="note alert alert-success"><div><ul><li>close</li><li>closes</li><li>closed</li><li>fix</li><li>fixes</li><li>fixed</li><li>resolve</li><li>resolves</li><li>resolved</li></ul></div></div><h3 id="Merge"><a href="#Merge" class="headerlink" title="Merge"></a>Merge</h3><p>Git 有两种合并，一种是 Fast Forward， 不会单独的合并节点；另一种 none Fast Forward，会生成单独的节点。</p><p>Fast Forward 不利于保持 commit信息的清晰，也不利于以后的 rollback，常用 <code>merge --no-ff</code>，只要发生合并，就要有一个单独的合并节点。</p><h3 id="Squash-mulitple-commit"><a href="#Squash-mulitple-commit" class="headerlink" title="Squash mulitple commit"></a>Squash mulitple commit</h3><p>为了便于其他人阅读提交，还有 <code>cherry-pick</code> 或撤销代码变化，在发起 <code>Pull Request</code> 之前，应该把多个commit合并成一个，前提是这个分支只有我一个人开发，没有merge过，也没有push过。<br>参考 <a href="/blog/2023/04/10/git/remote/#rebase-commit">rebase</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">git rebase -i HEAD~n<br></code></pre></td></tr></table></figure></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/blog/categories/workflow/" class="category-chain-item">workflow</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/blog/tags/git/" class="print-no-link">#git</a></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/blog/2023/04/11/english/NewComceptOne/Lesson1/" title="Excuse me!"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Excuse me!</span> <span class="visible-mobile">Previous</span></a></article><article class="post-next col-6"><a href="/blog/2023/04/11/english/introduce/" title="introduce myself"><span class="hidden-mobile">introduce myself</span> <span class="visible-mobile">Next</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>Table of Contents</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="modalSearchLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">Search</h4><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="modalSearchInput" class="form-control validate"> <label data-error="x" data-success="v" for="modalSearchInput">Keyword</label></div><div class="list-group" id="modalSearchResult"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="/blog/about" rel="nofollow noopener">blog <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart-fill" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/></svg> 1.3.0</a></div></div></footer><link rel="stylesheet" href="//cdn.staticfile.net/nprogress/0.2.0/nprogress.min.css"><script src="//cdn.staticfile.net/nprogress/0.2.0/nprogress.min.js"></script><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="//cdn.staticfile.net/typed.js/2.1.0/typed.umd.min.js"></script><script src="//cdn.staticfile.net/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script><script src="/blog/js/local-search.js"></script><script src="/blog/js/events.js"></script><script>!function(t){var e=document.getElementById("subtitle");e&&"Typed"in t&&(e.innerText="",e=e.getAttribute("data-typed-text"),new t.Typed("#subtitle",{strings:["  ",e],cursorChar:"_",typeSpeed:80,loop:!1}))}(window)</script><script src="//cdn.staticfile.net/tocbot/4.25.0/tocbot.min.js"></script><script src="/blog/js/post/toc.js"></script><script src="//cdn.staticfile.net/clipboard.js/2.0.11/clipboard.min.js"></script><script src="/blog/js/post/copying-code.js"></script><link rel="stylesheet" href="//cdn.staticfile.net/photoswipe/5.4.2/photoswipe.min.css"><script type="module" src="/blog/js/post/img-swipe.js"></script><script type="module" src="/blog/js/post/enable.js"></script><noscript><div class="noscript-warning">LNote works best with JavaScript enabled</div></noscript></body></html>